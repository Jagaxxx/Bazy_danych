"0",""
"0","tak_df <- df %>%"
"0","  filter(czy_pokrywa == ""Tak"") %>%"
"0","  count(accident_type, name = ""tak"")"
"0",""
"0","nie_df <- df %>%"
"0","  filter(czy_pokrywa == ""Nie"") %>%"
"0","  count(accident_type, name = ""nie"")"
"0",""
"0","wynik <- full_join(tak_df, nie_df, by = ""accident_type"") %>%"
"0","  mutate("
"0","    tak = replace_na(tak, 0),"
"0","    nie = replace_na(nie, 0),"
"0","    ratio = tak / (tak + nie),"
"0","    suma = tak + nie"
"0","  )"
"0",""
"0","idx_suma_max <- which.max(wynik$suma)"
"0","ratio_suma_max <- wynik$ratio[idx_suma_max]"
"0","accident_suma_max <- wynik$accident_type[idx_suma_max]"
"0",""
"0","idx_ratio_max <- which.max(wynik$ratio)"
"0","ratio_max <- wynik$ratio[idx_ratio_max]"
"0","accident_ratio_max <- wynik$accident_type[idx_ratio_max]"
"0","suma_ratio_max <- wynik$suma[idx_ratio_max]"
"0",""
"0","idx_ratio_min <- which.min(wynik$ratio)"
"0","ratio_min <- wynik$ratio[idx_ratio_min]"
"0","accident_ratio_min <- wynik$accident_type[idx_ratio_min]"
"0","suma_ratio_min <- wynik$suma[idx_ratio_min]"
