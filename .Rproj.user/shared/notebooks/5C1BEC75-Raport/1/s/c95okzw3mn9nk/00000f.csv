"0","#| echo: false"
"0","#| warning: false"
"0","#| fig.width: 9"
"0","#| fig.height: 7"
"0","#| fig.align: ""center"""
"0",""
"0","df <- dbGetQuery(con, """
"0","  SELECT "
"0","    payment.id_payment,"
"0","    payment.id_spaceflight,"
"0","    spaceflight.id_trip,"
"0","    trip_type.trip_name,"
"0","    trip_type.force_side"
"0","  FROM payment"
"0","  JOIN spaceflight ON payment.id_spaceflight = spaceflight.id_spaceflight"
"0","  JOIN trip_type ON spaceflight.id_trip = trip_type.id_trip"
"0",""")"
"0",""
"0","# Liczby klientów"
"0","klienci_na_wycieczke <- df %>%"
"0","  group_by(trip_name, force_side) %>%"
"0","  summarise(liczba_klientow = n(), .groups = ""drop"") %>%"
"0","  arrange(desc(liczba_klientow))"
"0",""
"0","# Łączna liczba klientów"
"0","laczna_liczba_klientow <- sum(klienci_na_wycieczke$liczba_klientow)"
"0",""
"0","# Wycieczka z największą liczbą klientów"
"0","najwiecej_klientow <- klienci_na_wycieczke %>%"
"0","  slice_max(order_by = liczba_klientow, n = 1, with_ties = FALSE)"
"0",""
"0","# Wycieczka z najmniejszą liczbą klientów"
"0","najmniej_klientow <- klienci_na_wycieczke %>%"
"0","  slice_min(order_by = liczba_klientow, n = 1, with_ties = FALSE)"
"0",""
"0","# Wykres"
"0","ggplot(klienci_na_wycieczke, aes(x = reorder(trip_name, -liczba_klientow), y = liczba_klientow, fill = force_side)) +"
"0","  geom_col() +"
"0","  geom_text(aes(label = liczba_klientow), vjust = -0.5, size = 5) +"
"0","  scale_fill_manual(values = c(""jasna"" = ""lightblue"", ""ciemna"" = ""pink"")) +"
"0","  labs("
"0","    title = ""Liczba klientów na wycieczkę"","
"0","    x = ""Wycieczka"","
"0","    y = ""Liczba klientów"","
"0","    fill = ""Strona mocy"""
"0","  ) +"
"0","  theme_minimal() +"
"0","  theme("
"0","    plot.title = element_text(size = 18, face = ""bold"", hjust = 0.5),"
"0","    axis.title = element_text(size = 14),"
"0","    axis.text.x = element_text(angle = 45, hjust = 1, size = 12),"
"0","    axis.text.y = element_text(size = 12)"
"0","  )"
