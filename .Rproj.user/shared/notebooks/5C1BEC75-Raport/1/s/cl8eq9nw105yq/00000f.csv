"0","#| echo: false"
"0","#| warning: false"
"0","#| fig.width: 9"
"0","#| fig.height: 7"
"0","#| fig.align: ""center"""
"0",""
"0","### POPULARNOŚĆ WYCIECZEK ###"
"0",""
"0","# Pobieramy dane"
"0","query1_1 <- """
"0","SELECT trip_type.trip_name, trip_type.force_side"
"0","FROM spaceflight"
"0","JOIN trip_type ON spaceflight.id_trip = trip_type.id_trip;"
"0",""""
"0",""
"0","df1_1 <- dbGetQuery(con, query1_1)"
"0",""
"0","# Zliczanie lotów na wycieczkę"
"0","df1_1_summary <- df1_1 %>%"
"0","  group_by(trip_name) %>%"
"0","  summarise("
"0","    liczba_lotow = n(),"
"0","    force_side = first(force_side),"
"0","    .groups = ""drop"""
"0","  )"
"0",""
"0","# Łączna liczba wycieczek"
"0","laczna_liczba_wycieczek <- sum(df1_1_summary$liczba_lotow)"
"0",""
"0","najpopularniejsza <- df1_1_summary %>%"
"0","  slice_max(order_by = liczba_lotow, n = 1, with_ties = FALSE)"
"0",""
"0","najmniej_popularna <- df1_1_summary %>%"
"0","  slice_min(order_by = liczba_lotow, n = 1, with_ties = FALSE)"
"0",""
"0","# Wykres"
"0","ggplot(df1_1_summary, aes(x = reorder(trip_name, -liczba_lotow),"
"0","                          y = liczba_lotow,"
"0","                          fill = force_side)) +"
"0","  geom_col() +"
"0","  geom_text(aes(label = liczba_lotow),"
"0","            vjust = -0.5, size = 5) +"
"0","  scale_fill_manual(values = c(""jasna"" = ""lightblue"", ""ciemna"" = ""pink"")) +"
"0","  labs(title = ""Popularność wycieczek"","
"0","       x = ""Wycieczka"","
"0","       y = ""Liczba lotów"","
"0","       fill = ""Strona Mocy"") +"
"0","  theme_minimal() +"
"0","  theme("
"0","    plot.title = element_text(size = 18, face = ""bold"", hjust = 0.5),"
"0","    axis.title.x = element_text(size = 14),"
"0","    axis.title.y = element_text(size = 14),"
"0","    axis.text.x = element_text(size = 12, angle = 45, hjust = 1),"
"0","    axis.text.y = element_text(size = 12),"
"0","    legend.title = element_text(size = 13),"
"0","    legend.text = element_text(size = 12)"
"0","  )"
