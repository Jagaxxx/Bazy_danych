"0","#| echo: false"
"0","#| warning: false"
"0",""
"0","query_2_2 <- ""SELECT"
"0","    ar.id_report,"
"0","    at.accident_type,"
"0","    i.type,"
"0","    IF(ic.id_accident IS NOT NULL, 1, 0) AS czy_pokrywa"
"0","FROM"
"0","    accident_report AS ar"
"0","        LEFT JOIN"
"0","    payment AS p ON p.id_payment = ar.id_payment"
"0","        LEFT JOIN"
"0","    insurance_coverage AS ic ON ic.id_insurance = p.id_insurance"
"0","        AND ic.id_accident = ar.id_accident"
"0","        LEFT JOIN"
"0","    insurance AS i ON p.id_insurance = i.id_insurance"
"0","        LEFT JOIN"
"0","    accident_type AS at ON ar.id_accident = at.id_accident"
"0",""
"0","ORDER BY"
"0","    ar.id_report;"""
"0",""
"0","df <- dbGetQuery(con, query_2_2)"
"0",""
"0","df$czy_pokrywa <- ifelse(df$czy_pokrywa == 1, ""Tak"", ""Nie"")"
"0","df$czy_pokrywa <- factor(df$czy_pokrywa, levels = c(""Nie"", ""Tak""))"
"0",""
"0",""
"0","ggplot(df, aes(x = accident_type, fill = czy_pokrywa)) + "
"0","  geom_bar() + "
"0","  labs(title = ""Liczba wypadków według rodzaju"", "
"0","       x = ""Rodzaj wypadku"", "
"0","       y = ""Liczba wypadków"", "
"0","       fill = ""Czy ubezpieczenie \npokrywa wypadek"") + "
"0","  scale_fill_manual(values = c(""Nie"" = ""lightpink"", ""Tak"" = ""lightblue"")) + "
"0","  theme(axis.text.x = element_text(angle = 45, hjust = 1))"
